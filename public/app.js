!function(){var e,t,n,o,i=document.querySelector("canvas"),c=i.getContext("2d"),d=new WebSocket("ws://"+document.location.host+"/api"),r=!1,u=window.innerWidth,a=window.innerHeight,s=[],h=[],l="ontouchstart"in document.documentElement,v=Date.now();window.onresize=function(){u=window.innerWidth,a=window.innerHeight};var m=function(e,o){return t=i.width/u*e,n=i.height/a*o,[Math.round(t),Math.round(n)]},w=function(e){return"touchmove"===e.type||"touchstart"===e.type?(clientX=e.targetTouches[0].clientX,clientY=e.targetTouches[0].clientY):(clientX=e.clientX,clientY=e.clientY),[clientX,clientY]},f=function(t){r=!0,o=w(t),e=m(o[0],o[1]),c.moveTo(e[0],e[1]),s.push(e)},g=function(t){r&&(o=w(t),e=m(o[0],o[1]),c.lineTo(e[0],e[1]),c.stroke(),s.push(e))},p=function(){var e,t,n;if(!r){for(e=0;e<h.length;e++)for(n=h[e].path,t=0;t<n.length;t++)0===t?c.moveTo(n[t][0],n[t][1]):t===n.length-1?c.stroke():c.lineTo(n[t][0],n[t][1]);h=[]}},E=function(){r=!1,d.send(JSON.stringify({path:s,id:v})),s=[],p()};l?(i.addEventListener("touchstart",f),i.addEventListener("touchend",E),i.addEventListener("touchcancel",E),i.addEventListener("touchleave",E),i.addEventListener("touchmove",g)):(i.addEventListener("mousedown",f),i.addEventListener("mousemove",g),i.addEventListener("mouseup",E),i.addEventListener("mouseleave",function(){r&&E()})),d.onmessage=function(e){var t=JSON.parse(e.data);t.id!==v&&(h.push(t),p())}}();