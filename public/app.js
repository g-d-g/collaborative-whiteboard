!function(){var e,t,n,o,i=document.querySelector("canvas"),c=i.getContext("2d"),u=new WebSocket("ws://"+document.location.host+"/api"),d=!1,a=window.innerWidth,r=window.innerHeight,s=[],h=[],l="ontouchstart"in document.documentElement,v=Date.now(),m=function(e,o){return t=i.width/a*e,n=i.height/r*o,[Math.round(t),Math.round(n)]},f=function(e){return"touchmove"===e.type||"touchstart"===e.type?(clientX=e.targetTouches[0].clientX,clientY=e.targetTouches[0].clientY):(clientX=e.clientX,clientY=e.clientY),[clientX,clientY]},g=function(t){d=!0,o=f(t),e=m(o[0],o[1]),c.moveTo(e[0],e[1]),s.push(e)},p=function(t){d&&(o=f(t),e=m(o[0],o[1]),c.lineTo(e[0],e[1]),c.stroke(),s.push(e))},E=function(){var e,t,n;if(!d){for(e=0;e<h.length;e++)for(n=h[e].path,t=0;t<n.length;t++)0===t?c.moveTo(n[t][0],n[t][1]):t===n.length-1?c.stroke():c.lineTo(n[t][0],n[t][1]);h=[]}},w=function(){d=!1,u.send(JSON.stringify({path:s,id:v})),s=[],E()};l?(i.addEventListener("touchstart",g),i.addEventListener("touchend",w),i.addEventListener("touchcancel",w),i.addEventListener("touchleave",w),i.addEventListener("touchmove",p)):(i.addEventListener("mousedown",g),i.addEventListener("mousemove",p),i.addEventListener("mouseup",w),i.addEventListener("mouseleave",function(){d&&w()})),u.onmessage=function(e){var t=JSON.parse(e.data);t.id!==v&&(h.push(t),E())}}();